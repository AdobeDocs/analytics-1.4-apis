(self.webpackChunkdev_site_documentation_template=self.webpackChunkdev_site_documentation_template||[]).push([[94904],{34028:function(e,n,t){"use strict";t.r(n),t.d(n,{_frontmatter:function(){return d},default:function(){return p}});var o=t(22122),s=t(19756),r=(t(15007),t(64983)),a=t(99536),i=["components"],d={},c={_frontmatter:d},l=a.Z;function p(e){var n=e.components,t=(0,s.Z)(e,i);return(0,r.mdx)(l,(0,o.Z)({},c,t,{components:n,mdxType:"MDXLayout"}),(0,r.mdx)("h1",{id:"php"},"PHP"),(0,r.mdx)("p",null,"In this section you will learn some highlights about the provided PHP code."),(0,r.mdx)("h2",{id:"replace-the-wsdl-file-in-the-provided-solution-code"},"Replace the WSDL file in the provided solution code"),(0,r.mdx)("p",null,"Each of the solution files provided in the articles contains a WSDL file. However, since this file does occasionally change, you should replace the OmnitureAdminServices.wsdl in the wsdl folder with the ",(0,r.mdx)("inlineCode",{parentName:"p"},"one")," you downloaded in ",(0,r.mdx)("a",{parentName:"p",href:"c_Download_the_Digital_Marketing_Suite_WSDL.md#"},"Step 3: Download the Experience Cloud WSDL"),"."),(0,r.mdx)("h2",{id:"review-the-soap-security-header-code"},"Review the SOAP security header code"),(0,r.mdx)("p",null,"The SOAPRequest.php file contains the following functions:"),(0,r.mdx)("ul",null,(0,r.mdx)("li",{parentName:"ul"},(0,r.mdx)("inlineCode",{parentName:"li"},"getSecurityHeader()")," function: Creates the SOAP security header to access the Analytics APIs."),(0,r.mdx)("li",{parentName:"ul"},"The sendRequest","(",")"," function: Sends the SOAP request with the security header to ",(0,r.mdx)("strong",{parentName:"li"},"Analytics"),".")),(0,r.mdx)("p",null,"You will need to replace the ",(0,r.mdx)("inlineCode",{parentName:"p"},"auth_login")," and ",(0,r.mdx)("inlineCode",{parentName:"p"},"auth_password")," values with your own authentication information."),(0,r.mdx)("pre",null,(0,r.mdx)("code",{parentName:"pre"},"/* Generates the security header required to access the Analytics API */ \nfunction getSecurityHeader() \n{ \n$auth_login = '<your user name>'; \n$auth_password = '<your shared secret>'; \n$company = ''; \n$nonce_part = 0; \n/* seed random */ \nlist($usec, $sec) = explode(' ', microtime()); \n/*srand((float) $sec + ((float) $usec * 100000));*/ \n/*$nonce = md5(rand());*/ \n$nonce = $nonce_part . '-' . $sec . '-' . $usec ; \n/*echo \"NONCE: $nonce\\n\";*/ \n$created = date(\"Y-m-d H:i:s\"); \n$combo_string = $nonce . $created . $auth_password; \n\n/* Note: the sha1 command is not available in all versions of PHP. If your version of PHP does not support this command, you \ncan use openssl directly with the command: \necho -n <string> | openssl dgst -sha1 */ \n$sha1_string = sha1($combo_string); \n$pwDigest = base64_encode($sha1_string); \n$headers = '<wsse:Security SOAP-ENV:mustUnderstand=\"1\"> \n<wsse:UsernameToken wsu:Id=\"User\"> \n<wsse:Username>'.$auth_login.'</wsse:Username> \n<wsse:Password Type=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401- \nwss-username-token-profile-1.0#PasswordDigest\">'.$pwDigest.'</wsse:Password> \n<wsse:Nonce>'.$nonce.'</wsse:Nonce> \n<wsu:Created>'.$created.'</wsu:Created> \n</wsse:UsernameToken> \n</wsse:Security>'; \nif($company){ \n$headers .= '<AdminInfo> \n<company>'.$company.'</company> \n</AdminInfo>'; \n} \n# echo \"headers: $headers\\n\"; \n\nreturn $headers; \n\n}/* getSecurityHeader()*/ \n\n/** \n* send a SOAP request to Analytics \n* \n* @param string $report_type \n* @param array $params Contains the Report Description for the request \n* \n* @return array $response Data Structure containing report description and data requested \n*/ \nfunction sendRequest($report_type, $params ) \n{ \nglobal $soap_client, $debug; \n$response = $soap_client->call( \n$report_type, \n$params, \n'http://www.omniture.com', //namespace \n'', //Soap Action \ngetSecurityHeader() \n); \n\nif($debug) echo \"\\n=== REQUEST ===\\n\" . $soap_client->request . \"\\n\"; \n\nif($debug) echo \"\\n=== RESPONSE ===\\n\" . $soap_client->response . \"\\n\"; \n\n/* Check the request response for issues */ \nif($err = $soap_client->getError()) \nthrow new Exception(\"sendRequest(): SOAP ERROR: $err\", 0); \n\nreturn($response); \n} \n")),(0,r.mdx)("h2",{id:"review-the-code-to-connect-to-the-wsdl"},"Review the code to connect to the WSDL"),(0,r.mdx)("p",null,"The provided PHP code uses the NuSOAP toolkit to create a client application to connect with the web service API."),(0,r.mdx)("p",null,"Each main PHP file uses the following code to connect to the local WSDL."),(0,r.mdx)("pre",null,(0,r.mdx)("code",{parentName:"pre"},"require_once('nusoap.php'); \n/* Include the common functions to send a SOAP request to Analytics. */ \nrequire_once('library/SOAPRequest.php'); \n\n/* Set the variables for the environment */ \nini_set('memory_limit', -1); \n$debug = true; \n\n/* Set a variable for the local copy of the wsdl file */ \n$wsdl = 'wsdl/OmnitureAdminServices.wsdl'; \n\n/* Error if wsdl file not found */ \nif ( !is_file($wsdl) ) throw new Exception('WSDL not located.', 0); \n\n/* Setup Data Center Soap Client object */ \n$soap_client = new soap_client($wsdl, TRUE); \n")),(0,r.mdx)("p",null,(0,r.mdx)("strong",{parentName:"p"},"Parent topic:")," ",(0,r.mdx)("a",{parentName:"p",href:"c_Update_the_Solution_Files.md"},"Step 4: Update the Solution Files")))}p.isMDXComponent=!0}}]);
//# sourceMappingURL=component---src-pages-guides-getting-started-c-php-md-d4b1621ddb4c48c5a994.js.map