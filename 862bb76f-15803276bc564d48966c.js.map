{"version":3,"file":"862bb76f-15803276bc564d48966c.js","mappings":"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","sources":["webpack://analytics-1.4-apis/./node_modules/@adobe/gatsby-theme-aio/src/components/GetCredential/MyCredential.js"],"sourcesContent":["import React, { useContext, useEffect, useState } from 'react';\r\nimport { css } from '@emotion/react';\r\nimport classNames from 'classnames';\r\nimport JSZip from 'jszip';\r\nimport JSZipUtils from 'jszip-utils';\r\nimport { saveAs } from 'file-saver';\r\nimport { MAX_TABLET_SCREEN_WIDTH, MIN_MOBILE_WIDTH } from './FormFields';\r\nimport { Toast } from '../Toast';\r\nimport { CardProducts } from './Products';\r\nimport { SideComponent } from './SideComponent';\r\nimport { AccessToken } from './Card/AccessToken';\r\nimport { DevConsoleLink } from './Card/DevConsoleLink';\r\nimport { CardClientDetails } from './Card/CardClientDetails';\r\nimport { SideContent } from './Form/SideContent';\r\nimport GetCredentialContext from './GetCredentialContext';\r\nimport { CredentialDetailsCard } from './CredentialDetailsCard';\r\n\r\nconst MyCredential = ({\r\n  formData,\r\n  response,\r\n  handleRestart\r\n}) => {\r\n  const { getCredentialData, selectedOrganization: organizationName } = useContext(GetCredentialContext);\r\n  const credentialProps = getCredentialData;\r\n\r\n  const [isDownloadStart, setIsDownloadStart] = useState();\r\n  const [isCopiedTooltip, setCopiedTooltip] = useState('');\r\n\r\n  const myCredentialFields = {};\r\n  const productsObj = { label: 'products', productList: [] };\r\n\r\n  credentialProps?.[MyCredential]?.children.forEach(({ type, props }) => {\r\n    myCredentialFields[type] = props;\r\n    if (props.children && type === CardClientDetails) {\r\n      props?.children?.forEach(({ type, props }) => {\r\n        myCredentialFields[type] = props;\r\n      });\r\n    }\r\n    if (type === CardProducts && props?.children) {\r\n      productsObj.productList.push(\r\n        ...[].concat(props.children).map(({ props: { label, icon } }) => ({ label, icon }))\r\n      );\r\n    }\r\n  });\r\n  const product = productsObj?.productList;\r\n\r\n  useEffect(() => {\r\n    if (formData['Downloads']) {\r\n      downloadZIP(\r\n        `/console/api/organizations/${organizationName?.id}/projects/${response.projectId}/workspaces/${response.workspaceId}/download`,\r\n        formData['Download'],\r\n        formData['zipUrl']\r\n      );\r\n    }\r\n  }, []);\r\n\r\n  const card = credentialProps?.[MyCredential];\r\n\r\n  const downloadZIP = async (downloadAPI, fileName = 'download', zipFileURL) => {\r\n    setIsDownloadStart(true);\r\n    try {\r\n      const zipData = await JSZipUtils.getBinaryContent(zipFileURL);\r\n      const zipArrayBuffer = new Uint8Array(zipData).buffer;\r\n      const zip = new JSZip();\r\n\r\n      await zip.loadAsync(zipArrayBuffer);\r\n\r\n      const token = window.adobeIMS?.getTokenFromStorage()?.token;\r\n      const options = {\r\n        method: 'GET',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n          Authorization: 'Bearer ' + token,\r\n          'x-api-key': window?.adobeIMS?.adobeIdData?.client_id,\r\n        },\r\n      };\r\n\r\n      const response = await fetch(downloadAPI, options);\r\n\r\n      if (response.status === 200) {\r\n        const credential = await response.json();\r\n\r\n        zip.file('credential.json', JSON.stringify(credential));\r\n\r\n        const modifiedZipBlob = await zip.generateAsync({ type: 'blob' });\r\n        saveAs(modifiedZipBlob, `${fileName}.zip`);\r\n      } else {\r\n        console.error('Failed to fetch additional data. Response status:', response.status);\r\n      }\r\n    } catch (error) {\r\n      console.error('An error occurred:', error);\r\n    } finally {\r\n      setIsDownloadStart(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div\r\n      className={classNames(card?.className)}\r\n      css={css`\r\n        display: flex;\r\n        flex-direction: column;\r\n        gap: 48px;\r\n      `}>\r\n      <div\r\n        className={classNames(card?.className)}\r\n        css={css`\r\n          display: flex;\r\n          flex-direction: column;\r\n          gap: 16px;\r\n          color: var(--spectrum-global-color-gray-800);\r\n          width: 100%;\r\n          height: 100%;\r\n          text-align: left;\r\n\r\n          @media screen and (min-width: ${MIN_MOBILE_WIDTH}) and (max-width: ${MAX_TABLET_SCREEN_WIDTH}) {\r\n            padding: 0;\r\n            width: 100%;\r\n          }\r\n        `}>\r\n        <div\r\n          css={css`\r\n            display: flex;\r\n            gap: 20px;\r\n            align-items: baseline;\r\n          `}>\r\n          {card?.title && (\r\n            <h2\r\n              className=\"spectrum-Heading spectrum-Heading--sizeL\"\r\n              css={css`\r\n                font-weight: 700;\r\n                color: var(--spectrum-global-color-gray-900);\r\n              `}>\r\n              {card?.title}\r\n            </h2>\r\n          )}\r\n          {isDownloadStart && (\r\n            <div\r\n              css={css`\r\n                display: flex;\r\n                text-align: center;\r\n                align-items: center;\r\n                gap: 10px;\r\n              `}>\r\n              <div className=\"spectrum-ProgressCircle spectrum-ProgressCircle--indeterminate spectrum-ProgressCircle--small\">\r\n                <div className=\"spectrum-ProgressCircle-track\"></div>\r\n                <div className=\"spectrum-ProgressCircle-fills\">\r\n                  <div className=\"spectrum-ProgressCircle-fillMask1\">\r\n                    <div className=\"spectrum-ProgressCircle-fillSubMask1\">\r\n                      <div className=\"spectrum-ProgressCircle-fill\"></div>\r\n                    </div>\r\n                  </div>\r\n                  <div className=\"spectrum-ProgressCircle-fillMask2\">\r\n                    <div className=\"spectrum-ProgressCircle-fillSubMask2\">\r\n                      <div className=\"spectrum-ProgressCircle-fill\"></div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              <p\r\n                css={css`\r\n                  margin: 0;\r\n                `}>\r\n                Downloading...\r\n              </p>\r\n            </div>\r\n          )}\r\n        </div>\r\n        {formData['Downloads'] && card?.paragraph && (\r\n          <p\r\n            className=\"spectrum-Body spectrum-Body--sizeL\"\r\n            css={css`\r\n              color: var(--spectrum-global-color-gray-900);\r\n            `}>\r\n            {card?.paragraph}\r\n          </p>\r\n        )}\r\n        {formData['Downloads'] && (\r\n          <p\r\n            className=\"spectrum-Body spectrum-Body--sizeS\"\r\n            css={css`\r\n              color: var(--spectrum-global-color-gray-900);\r\n            `}>\r\n            Download not working?\r\n            <button\r\n              css={css`\r\n                padding: 0;\r\n                font-family: 'adobe-clean';\r\n                border: none;\r\n                background: transparent;\r\n                margin-left: 10px;\r\n                cursor: pointer;\r\n                text-decoration: underline;\r\n                color: rgb(0, 84, 182);\r\n                &:hover {\r\n                  color: rgb(2, 101, 220);\r\n                }\r\n              `}\r\n              onClick={() =>\r\n                downloadZIP(\r\n                  `/console/api/organizations/${organizationName?.id}/projects/${response.projectId}/workspaces/${response.workspaceId}/download`,\r\n                  formData['Download'],\r\n                  formData['zipUrl']\r\n                )\r\n              }\r\n              data-cy=\"restart-download\">\r\n              Restart download\r\n            </button>\r\n          </p>\r\n        )}\r\n      </div>\r\n      <div\r\n        css={css`\r\n          display: flex;\r\n          gap: 35px;\r\n\r\n          @media screen and (min-width: ${MIN_MOBILE_WIDTH}) and (max-width: ${MAX_TABLET_SCREEN_WIDTH}) {\r\n            flex-direction: column;\r\n            padding-left: 0;\r\n          }\r\n        `}>\r\n        <div\r\n          css={css`\r\n            display: flex;\r\n            flex-direction: column;\r\n            gap: 35px;\r\n            width: 50%;\r\n\r\n            @media screen and (min-width: ${MIN_MOBILE_WIDTH}) and (max-width: ${MAX_TABLET_SCREEN_WIDTH}) {\r\n              width: 100%;\r\n            }\r\n          `}>\r\n          <CredentialDetailsCard\r\n            credentialName={formData['CredentialName']}\r\n            productList={product}\r\n            ProductComponent={CardProducts}\r\n            AccessTokenComponent={AccessToken}\r\n            DevConsoleLinkComponent={DevConsoleLink}\r\n            ClientDetailsComponent={CardClientDetails}\r\n            allowedOriginsDetails={formData['AllowedOrigins']}\r\n            organizationName={organizationName}\r\n            response={response}\r\n            nextButtonLink={card?.nextStepsHref}\r\n            nextButtonLabel={card?.nextStepsLabel}\r\n            devConsoleLink={card?.devConsoleDirection}\r\n            developerConsoleManage={card?.developerConsoleManage}\r\n            myCredentialFields={myCredentialFields}\r\n          />\r\n          <div\r\n            css={css`\r\n              display: flex;\r\n              flex-direction: column;\r\n              gap: 8px;\r\n              width: 80%;\r\n            `}>\r\n            <h4\r\n              className=\"spectrum-Heading spectrum-Heading--sizeXS\"\r\n              css={css`\r\n                font-weight: 700;\r\n                color: var(--spectrum-global-color-gray-900);\r\n              `}>\r\n              Need another credential\r\n            </h4>\r\n            <p className=\"spectrum-Body spectrum-Body--sizeS\">\r\n              <button\r\n                onClick={handleRestart}\r\n                css={css`\r\n                  border: none;\r\n                  padding: 0;\r\n                  font-family: 'adobe-clean';\r\n                  background: transparent;\r\n                  color: var(--spectrum-global-color-gray-800);\r\n                  text-decoration: underline;\r\n                  cursor: pointer;\r\n                  &:hover {\r\n                    color: var(--spectrum-global-color-gray-900);\r\n                  }\r\n                `} data-cy=\"Restart-new-credential\">\r\n                Restart and create a new credential\r\n              </button>\r\n            </p>\r\n          </div>\r\n        </div>\r\n        {card?.children ? (\r\n          <SideContent\r\n            sideContent={myCredentialFields[SideComponent]?.children}\r\n            SideComp={SideComponent}\r\n          />\r\n        ) : null}\r\n      </div>\r\n      {isCopiedTooltip && (\r\n        <Toast\r\n          variant=\"success\"\r\n          message=\"Copied to clipboard\"\r\n          disable={1000}\r\n          customDisableFunction={setCopiedTooltip}\r\n        />\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport { MyCredential };\r\n"],"names":["MyCredential","formData","response","handleRestart","useContext","GetCredentialContext","getCredentialData","organizationName","selectedOrganization","credentialProps","useState","isDownloadStart","setIsDownloadStart","isCopiedTooltip","setCopiedTooltip","myCredentialFields","productsObj","label","productList","children","forEach","type","props","CardClientDetails","CardProducts","push","concat","map","icon","product","useEffect","downloadZIP","id","projectId","workspaceId","card","downloadAPI","fileName","zipFileURL","JSZipUtils","zipData","zipArrayBuffer","Uint8Array","buffer","zip","JSZip","loadAsync","token","window","adobeIMS","getTokenFromStorage","options","method","headers","Authorization","adobeIdData","client_id","fetch","status","json","credential","file","JSON","stringify","generateAsync","modifiedZipBlob","saveAs","console","error","className","classNames","css","MIN_MOBILE_WIDTH","MAX_TABLET_SCREEN_WIDTH","title","paragraph","onClick","credentialName","ProductComponent","AccessTokenComponent","AccessToken","DevConsoleLinkComponent","DevConsoleLink","ClientDetailsComponent","allowedOriginsDetails","nextButtonLink","nextStepsHref","nextButtonLabel","nextStepsLabel","devConsoleLink","devConsoleDirection","developerConsoleManage","sideContent","SideComponent","SideComp","variant","message","disable","customDisableFunction"],"sourceRoot":""}