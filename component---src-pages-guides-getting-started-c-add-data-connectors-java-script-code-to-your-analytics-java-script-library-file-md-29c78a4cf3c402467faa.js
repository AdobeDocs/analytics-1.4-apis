(self.webpackChunkdev_site_documentation_template=self.webpackChunkdev_site_documentation_template||[]).push([[37897],{53912:function(e,t,a){"use strict";a.r(t),a.d(t,{_frontmatter:function(){return i},default:function(){return m}});var n=a(22122),r=a(19756),o=(a(15007),a(64983)),d=a(99536),s=["components"],i={},l={_frontmatter:i},p=d.Z;function m(e){var t=e.components,a=(0,r.Z)(e,s);return(0,o.mdx)(p,(0,n.Z)({},l,a,{components:t,mdxType:"MDXLayout"}),(0,o.mdx)("h1",{id:"step-3-add-data-connectors-javascript-code-to-your-analytics-javascript-library-file"},"Step 3: Add Data Connectors JavaScript Code to your Analytics JavaScript Library File"),(0,o.mdx)("p",null,"The Data Connectors Integrate module code is a JavaScript code framework which provides methods for Customers to retrieve product data or pass Analytics variables back to a Data Connectors product. The retrieved product data can be used any way you like. For instance, you can display it in your web site or send it back to the Adobe Data Collection Layer. In this tutorial, you will do both."),(0,o.mdx)("p",null,"In this section, you will:"),(0,o.mdx)("ul",null,(0,o.mdx)("li",{parentName:"ul"},(0,o.mdx)("p",{parentName:"li"},"Review the code that the Data Connectors product implements for the integration")),(0,o.mdx)("li",{parentName:"ul"},(0,o.mdx)("p",{parentName:"li"},"Review the code that you defined to map your variables to the product")),(0,o.mdx)("li",{parentName:"ul"},(0,o.mdx)("p",{parentName:"li"},"Review the code that simulates the server-side product data")),(0,o.mdx)("li",{parentName:"ul"},(0,o.mdx)("p",{parentName:"li"},"Customize the code to process the product data only on one web page"))),(0,o.mdx)("h2",{id:"data-connectors-product-code"},"Data Connectors product code"),(0,o.mdx)("p",null,"In this section, you will review the code that the Data Connectors product provides to you after you activate an integration. This section is informational only, to provide you with a basic understanding of how Data Connectors integrate code works."),(0,o.mdx)("ol",null,(0,o.mdx)("li",{parentName:"ol"},"In the ",(0,o.mdx)("strong",{parentName:"li"},"js")," folder, open the integrate","_","code.js file. This file contains the JavaScript code that the Data Connectors product implements for the integration."),(0,o.mdx)("li",{parentName:"ol"},"Select all the code in the integrate","_","code.js file."),(0,o.mdx)("li",{parentName:"ol"},"Copy and paste this code in to your JavaScript library file ","(","s","_","code.js",")"," file, after the ",(0,o.mdx)("strong",{parentName:"li"},"Config"),' section and before the comment which states, "',(0,o.mdx)("strong",{parentName:"li"},"DO NOT ALTER ANYTHING BELOW THIS LINE !"),'".'),(0,o.mdx)("li",{parentName:"ol"},"In the ",(0,o.mdx)("strong",{parentName:"li"},"s","_","code.js")," file, locate the ",(0,o.mdx)("strong",{parentName:"li"},"s.loadModule","(",")")," function.")),(0,o.mdx)("p",null,"The ",(0,o.mdx)("strong",{parentName:"p"},"s.loadModule","(",")"),' function has one argument which defines the module to load in to the "',(0,o.mdx)("strong",{parentName:"p"},"s"),'" object. Remember that the s',"_",'code.js file uses "',(0,o.mdx)("strong",{parentName:"p"},"s"),'" as the default reference object for Analytics data. In this case the Data Connectors Partner has specified the',(0,o.mdx)("strong",{parentName:"p"},'"Integrate"')," module to be loaded so that its methods can be called in the next steps."),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre"},'s.loadModule() function\n \ns.loadModule("Integrate");\n')),(0,o.mdx)("ol",null,(0,o.mdx)("li",{parentName:"ol"},"In the s","_","code.js file, locate the ",(0,o.mdx)("strong",{parentName:"li"},"s.Integrate.add","(",")")," method.")),(0,o.mdx)("p",null,"The ",(0,o.mdx)("strong",{parentName:"p"},"add","(",")")," method instantiates a partner object as an intermediate area to hold variable data. Each Data Connectors product will have a unique partner object name."),(0,o.mdx)("p",null,'In this example, the Data Connectors Partner has named this argument, "',(0,o.mdx)("strong",{parentName:"p"},"JJEsquireTwitterPod"),'"..'),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre"},'Integrate add() method\n \ns.loadModule("Integrate");\ns.Integrate.add("JJEsquireTwitterPod");\n')),(0,o.mdx)("h2",{id:"mapped-variable-code"},"Mapped variable code"),(0,o.mdx)("p",null,"In this section, you will review the code that maps the Data Connectors product variables to the Analytics variables. These are all the variables which you mapped in Step 1 of this tutorial, ",(0,o.mdx)("strong",{parentName:"p"},"Activate the integration for your Analytics report suite"),"."),(0,o.mdx)("p",null,"You do not need to make any changes to this code, as it is provided to you from the Adobe engineering team."),(0,o.mdx)("ol",null,(0,o.mdx)("li",{parentName:"ol"},"In the s","_","code.js file, locate the ",(0,o.mdx)("strong",{parentName:"li"},"s.Integrate.JJEsquireTwitterPod.setVars","(",")")," method.")),(0,o.mdx)("p",null,"The ",(0,o.mdx)("strong",{parentName:"p"},"setVars","(",")")," method maps Data Connectors product data to your Analytics variables."),(0,o.mdx)("p",null,"The syntax for the ",(0,o.mdx)("strong",{parentName:"p"},"setVars","(",")")," method is shown below."),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre"},"Integrate setVars() method syntax\n \ns.Integrate.<partnerName>.setVars = function (s,p) {\ns.<SCVar1> = p.<PVar1>;\ns.<SCVar2> = p.<PVar2>;\n...\ns.<SCVarN> = p.<PVarN>;\n};\n")),(0,o.mdx)("p",null,"The ",(0,o.mdx)("strong",{parentName:"p"},"setVars","(",")")," method has the following properties as shown in Table 1."),(0,o.mdx)("table",null,(0,o.mdx)("thead",{parentName:"table"},(0,o.mdx)("tr",{parentName:"thead"},(0,o.mdx)("th",{parentName:"tr",align:null},"Property"),(0,o.mdx)("th",{parentName:"tr",align:null},"Description"))),(0,o.mdx)("tbody",{parentName:"table"},(0,o.mdx)("tr",{parentName:"tbody"},(0,o.mdx)("td",{parentName:"tr",align:null},"partnerName"),(0,o.mdx)("td",{parentName:"tr",align:null},"The name of the partner object created with the add","(",")"," method.")),(0,o.mdx)("tr",{parentName:"tbody"},(0,o.mdx)("td",{parentName:"tr",align:null},"s"),(0,o.mdx)("td",{parentName:"tr",align:null},"The reference object for Analytics data.")),(0,o.mdx)("tr",{parentName:"tbody"},(0,o.mdx)("td",{parentName:"tr",align:null},"p"),(0,o.mdx)("td",{parentName:"tr",align:null},"The reference object for Data Connectors product data.")),(0,o.mdx)("tr",{parentName:"tbody"},(0,o.mdx)("td",{parentName:"tr",align:null},"SCVarN"),(0,o.mdx)("td",{parentName:"tr",align:null},"The name of the Analytics variable to be assigned a value from a Data Connectors product variable.")),(0,o.mdx)("tr",{parentName:"tbody"},(0,o.mdx)("td",{parentName:"tr",align:null},"PVarN"),(0,o.mdx)("td",{parentName:"tr",align:null},"The name of the of the Data Connectors product variable to import into Analytics.")))),(0,o.mdx)("p",null,"Table 1. The Integrate setVars","(",")"," function properties"),(0,o.mdx)("p",null,"Notice that ",(0,o.mdx)("strong",{parentName:"p"},"s.eVar3")," is set to ",(0,o.mdx)("strong",{parentName:"p"},"p.twitter","_","handle")," and ",(0,o.mdx)("strong",{parentName:"p"},"s.events")," is set to ",(0,o.mdx)("strong",{parentName:"p"},'"event3"'),"."),(0,o.mdx)("p",null,"In this demo, the custom conversion variable, ",(0,o.mdx)("strong",{parentName:"p"},"eVar3"),", is set to the Twitter handle of the current visitor to the web site. The custom event, ",(0,o.mdx)("strong",{parentName:"p"},"event3"),", is set to track the number of followers for the current visitor."),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre"},'Integrate setVars() method\n \ns.loadModule("Integrate");\ns.Integrate.add("JJEsquireTwitterPod");\ns.Integrate.JJEsquireTwitterPod.setVars=function(s,p)\n{\n      s.eVar3 = p.twitter_handle;\n      s.events = "event3";\n}\n')),(0,o.mdx)("ol",null,(0,o.mdx)("li",{parentName:"ol"},"In the s","_","code.js file, locate the",(0,o.mdx)("strong",{parentName:"li"},"s.products")," variable.")),(0,o.mdx)("p",null,"The ",(0,o.mdx)("strong",{parentName:"p"},"s.products")," variable is used in conjunction with the event to pass additional data, such as product name and event value. The product name is set so that it can be viewed in the Products Report in Analytics. You will see the data in the Products Report in ",(0,o.mdx)("strong",{parentName:"p"},"Step 6: Run Analytics reports to verify Partner data collection"),"."),(0,o.mdx)("p",null," ",(0,o.mdx)("strong",{parentName:"p"},"Note"),": You can learn more about this and other Analytics variables in the ",(0,o.mdx)("strong",{parentName:"p"},"Collect visitor analytics using Analytics JavaScript Tagging")," tutorial."),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre"},'s.products parameters\n \ns.products = "Category; Product; Quantity; Price; Event  [, Category; Product; Quantity; Price; Event]"\n')),(0,o.mdx)("p",null,(0,o.mdx)("strong",{parentName:"p"},"s.products parameters"),' s.products = "Category; Product; Quantity; Price; Event ',"[",", Category; Product; Quantity; Price; Event","]",'"'),(0,o.mdx)("p",null," ",(0,o.mdx)("strong",{parentName:"p"},"Note"),": Use a semicolon between values in one product and a comma to separate products."),(0,o.mdx)("p",null,"Notice that the product name is set to ",(0,o.mdx)("strong",{parentName:"p"},"follower","_","count")," and the ",(0,o.mdx)("strong",{parentName:"p"},"event3")," value is set to the number of followers for the current visitor."),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre"},'Integrate setVars() method\n \ns.loadModule("Integrate");\ns.Integrate.add("JJEsquireTwitterPod");\ns.Integrate.JJEsquireTwitterPod.setVars=function(s,p)\n{\n                   s.eVar3 = p.twitter_handle;\n      s.events = "event3";\n                   s.products = ";follower_count;;;event3=" + p.twitter_followers;\n}\n')),(0,o.mdx)("h2",{id:"code-to-simulate-server-side-product-data"},"Code to simulate server-side product data"),(0,o.mdx)("p",null,"In this section, you will review the code which simulates retrieving product data from the server. Typically, the Data Connectors Partner will use the ",(0,o.mdx)("strong",{parentName:"p"},"get","(",")")," method to import product data from a url. This code would be included in the Data Connectors JavaScript code provided to you."),(0,o.mdx)("p",null,"To simplify this demo, you will not use server-side technology. Instead, you will call the ",(0,o.mdx)("strong",{parentName:"p"},"getTwitterData","(",")")," function within the",(0,o.mdx)("strong",{parentName:"p"},"twitter","_","generator.js")," JavaScript file to simulate returning product data from the server. The data is returned as a JSON object, which is then assigned to the product variables."),(0,o.mdx)("p",null,"You do not need to make any changes to this code, as it is provided to you from the Adobe engineering team."),(0,o.mdx)("ol",null,(0,o.mdx)("li",{parentName:"ol"},"In the s","_","code.js file, locate the call to the ",(0,o.mdx)("strong",{parentName:"li"},"getTwitterData","(",")")," method and the assignment of the",(0,o.mdx)("strong",{parentName:"li"},"p.twitter","_","handle")," and",(0,o.mdx)("strong",{parentName:"li"},"p.twitter","_","followers")," product variables.")),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre"},'Statically set partner object variables\n \ns.loadModule("Integrate");\ns.Integrate.add("JJEsquireTwitterPod");\ns.Integrate.JJEsquireTwitterPod.setVars=function(s,p)\n{\n      eval(getTwitterData());\n      p.twitter_handle = s_1_Integrate_twitterexample_get_0.author_handle;\n      p.twitter_followers = s_1_Integrate_twitterexample_get_0.followers;  \n                   s.eVar3 = p.twitter_handle;\n      s.events = "event3";\n                   s.products = ";follower_count;;;event3=" + p.twitter_followers;\n              }\n')),(0,o.mdx)("h2",{id:"custom-code-to-process-product-data-only-on-one-web-page"},"Custom code to process product data only on one web page"),(0,o.mdx)("p",null,"In this section, you will add a conditional statement to the Data Connectors JavaScript code provided to you, to retrieve the product data and assign it to Analytics variables only on the web page where the data is used."),(0,o.mdx)("p",null,"Because each web application page with Analytics JavaScript code calls the s","_","code.js file, you will add a conditional statement to the Data Connectors JavaScript code in the s","_","code.js file to check the current page. Since the product data associated with the twitter handle and twitter followers is only relevant for the JJ. Esquire Product List page, you will check for this web page."),(0,o.mdx)("ol",null,(0,o.mdx)("li",{parentName:"ol"},"Add an ",(0,o.mdx)("strong",{parentName:"li"},"if")," statement that checks whether the visitor is on the product list page of the application. Check the ",(0,o.mdx)("strong",{parentName:"li"},"s.pageName"),' variable which is set on each web page within the Analytics JavaScript page code for a value of "',(0,o.mdx)("strong",{parentName:"li"},"Product List Page"),'".')),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre"},'Integrate setVars() method\n \ns.loadModule("Integrate");\ns.Integrate.add("JJEsquireTwitterPod");\ns.Integrate.JJEsquireTwitterPod.setVars=function(s,p)\n{\nif(s.pageName=="Product List Page"){\n      eval(getTwitterData());\n      p.twitter_handle = s_1_Integrate_twitterexample_get_0.author_handle;\n      p.twitter_followers = s_1_Integrate_twitterexample_get_0.followers;        \n                                s.eVar3 = p.twitter_handle;\n      s.events = "event3";\n                                s.products = ";follower_count;;;event3=" + p.twitter_followers;\n}\n}\n')),(0,o.mdx)("p",null,(0,o.mdx)("strong",{parentName:"p"},"Parent topic:")," ",(0,o.mdx)("a",{parentName:"p",href:"c_Integrate_Data_Connectors_Partner_Data_into_Customer_Application.md"},"3. Integrate Partner Data Tutorial")))}m.isMDXComponent=!0}}]);
//# sourceMappingURL=component---src-pages-guides-getting-started-c-add-data-connectors-java-script-code-to-your-analytics-java-script-library-file-md-29c78a4cf3c402467faa.js.map